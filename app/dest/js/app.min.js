'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Contact = function () {
    function Contact(lastName, firstName, gender, age, check) {
        _classCallCheck(this, Contact);

        this.lastName = lastName;
        this.firstName = firstName;
        this.gender = gender;
        this.age = age;
        this.check = check;
    }

    _createClass(Contact, [{
        key: 'empty',
        value: function empty() {
            if (this.fieldEmpty('lastName') || this.fieldEmpty('firstName') || this.fieldEmpty('gender') || this.fieldEmpty('age')) return true;else return false;
        }
    }, {
        key: 'fieldEmpty',
        value: function fieldEmpty(name) {
            if (this[name] === null || this[name] === undefined || this[name] === "" || this[name] === 0) return true;else return false;
        }
    }]);

    return Contact;
}();
'use strict';

$(function () {

    Vue.prototype.$eventHub = new Vue();

    var config = {
        errorBagName: 'errors', // change if property conflicts
        fieldsBagName: 'fields',
        delay: 0,
        locale: 'en',
        dictionary: null,
        strict: true,
        classes: true,
        classNames: {
            touched: 'touched', // the control has been blurred
            untouched: 'untouched', // the control hasn't been blurred
            valid: 'valid', // model is valid
            invalid: 'invalid', // model is invalid
            pristine: 'pristine', // control has not been interacted with
            dirty: 'dirty' // control has been interacted with
        },
        events: 'input|blur|submit',
        inject: true,
        validity: true,
        aria: true
    };

    Vue.use(VeeValidate, config);

    if ($('#root')) new Vue({
        el: '#root',
        data: {
            contacts: [],
            contact: new Contact(),
            age: [20, 21, 22, 23, 24],
            gender: [{ label: 'Male', value: 'm', check: true }, { label: 'Female', value: 'f', check: false }],
            example: {
                upper: 'Upper',
                lower: 'Lower',
                trim: '   trim    ',
                number: 'number',
                bool: false,
                string: 'test',
                title: 'title',
                replace: 'abcdefgjklmnoprstqwyz',
                address: ' Lgh VÃ¤g',
                postalCode: '11111',
                phoneNumber: '32321231321'
            },
            validation: {}
        },
        created: function created() {
            var _this = this;

            this.$eventHub.$on('errors-changed', function (errors) {
                _this.errors.clear();
                // console.log(this.errors);
                // this.errors.forEach((e) => {
                //     this.errors.add(e.field, e.msg, e.rule, e.scope);
                // });
            });
        },
        mounted: function mounted() {
            var _this2 = this;

            this.contacts = [new Contact('iuhwef', 'wefwef', 'm', 20), new Contact('efwg', 'fweg', 'f', 22), new Contact('iuhwef', 'hrth', 'm', 24), new Contact('gerrhe', 'rehewrg', 'f', 21), new Contact('sdgsgtwe', 'wegwe', 'f', 22)];

            //Emit that validation is required on the this.$eventHub
            this.$on('VeeValidate', function () {
                _this2.$eventHub.$emit('validate');
            });
            //Listen on the this.$eventHub for changers to the child components error bag and merge in/remove errors
            this.$eventHub.$on('errors-changed', function (newErrors, oldErrors) {
                // console.log('error-changes', newErrors, oldErrors);
                // return;
                // if (newErrors) {
                //     newErrors.items.forEach(error => {
                //         if (!this.errors.has(error.field)) {
                //             this.errors.add(error.field, error.msg)
                //         }
                //     });
                // }
                // if (oldErrors) {
                //     oldErrors.forEach(error => {
                //         this.errors.remove(error.field)
                //     })
                // }
            });
        },

        methods: {
            getContact: function getContact(contact) {
                this.contact = contact;
            },
            addContact: function addContact() {
                this.isValid();
                if (!this.contact.empty()) {
                    this.contacts.push(this.contact);
                    this.contact = new Contact();
                    this.reset();
                }
            },

            reset: function reset() {
                this.contact = new Contact();
                this.$children.map(function (child) {
                    child.$validator.reset();
                });
            },
            isValid: function isValid() {
                this.$children.map(function (child) {
                    child.$validator.validateAll().then(function (response) {
                        return response;
                    }).catch(function (response) {
                        return response;
                    });
                });
            },
            submit: function submit() {
                // this.$validator.validateAll();
                // if (this.errors.any()) {
                //     this.$eventHub.$emit('errors-changed', this.errors)
                // }
                this.$eventHub.$emit('validate');
            },
            validateChild: function validateChild() {
                this.$eventHub.$emit('validate');
            },
            clearChild: function clearChild() {
                this.$eventHub.$emit('clear');
            }
        }
    });
});